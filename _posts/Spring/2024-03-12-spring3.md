---
layout: single
title:  "[ì¸í”„ëŸ°ê°•ì˜] 3. íšŒì› ê´€ë¦¬ ì˜ˆì œ"
categories: Spring
sidebar_main: true


---

ìš°ì•„í•œí˜•ì œë“¤ ê¹€ì˜í•œë‹˜ì˜ ìŠ¤í”„ë§ ì…ë¬¸ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬
{: .notice--danger}


## ğŸ’¡ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ êµ¬ì¡°

![str](/assets/images/20240312/str.JPG)

- ì»¨íŠ¸ë¡¤ëŸ¬ : ì›¹ MVCì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì—­í• 
- ì„œë¹„ìŠ¤ : í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„
- ë¦¬í¬ì§€í† ë¦¬ : ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼, ë„ë©”ì¸ ê°ì²´ë¥¼ DBì— ì €ì¥í•˜ê³  ê´€ë¦¬
- ë„ë©”ì¸ : ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ê°ì²´ (íšŒì›, ì£¼ë¬¸ ë“±ë“±ì„ ì£¼ë¡œ DBì— ì €ì¥í•˜ê³  ê´€ë¦¬)

<br/>

<hr/>

<br/>

![st](/assets/images/20240312/st.JPG)

ì¼ë‹¨ ì´ë ‡ê²Œ êµ¬ì„±ì„ í•´ì„œ ê°„ë‹¨í•œ íšŒì› ê´€ë¦¬ë¥¼ í•´ë³´ì.

<br/>

### íšŒì› ë„ë©”ì¸

```java
package hello.hellospring.domain;

public class Member {
    
    private Long id;
    private String name;
    
    public Long getId(){
        return id;
    }
    
    public void setId(Long id){
        this.id = id;
    }
    
    public String getName(){
        return name;
    }
    
    public void setName(String id){
        this.name = name;
    }
}
```

<br/>

<hr/>

<br/>

### íšŒì› ë ˆí¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤

```java
package hello.hellospring.repository;

import hello.hellospring.domain.Member;

import java.util.List;
import java.util.Optional;

public interface MemberRepository{
    
    Member save(Member member);  //ë©¤ë²„ë¥¼ ì €ì¥í•˜ëŠ” ë©”ì„œë“œ
    Optional<Member> findById(Long id); //idë¡œ ë©¤ë²„ë¥¼ ì°¾ëŠ” ë©”ì„œë“œ
    Optional<Member> findByName(String name); //nameìœ¼ë¡œ ë©¤ë²„ë¥¼ ì°¾ëŠ” ë©”ì„œë“œ
    List<Member> findAll();
   
}
```

<br/>

<hr/>

<br/>

### íšŒì› ë ˆí¬ì§€í† ë¦¬ ë©”ëª¨ë¦¬ êµ¬í˜„

```java
package hello.hellospring.repository;

import hello.hellospring.domain.Member;

import java.util.*;

public calss MemoryMemberRepository implements MemberRepository
{  //ìƒì†í•˜ì—¬ ì˜¤ë²„ë¼ì´ë”© ë©”ì†Œë“œë¥¼ êµ¬í˜„í•´ì•¼í•œë‹¤.
    private static Map<Long, Member> store = new HashMap<>();
    private static long sequence = 0L;  //OL : long í˜•ì‹ì˜ 0ì„.
    
    @Override
    public Member save(Member member)
    {
    	member.setId(++sequence);   //sequenceë¥¼ ëŠ˜ë¦¬ë©´ì„œ memberì— ì €ì¥
        store.put(member.getId(), member); //HashMapì— idë¥¼ í‚¤ë¡œ, memberë¥¼ ê°’ìœ¼ë¡œ ìŒì„ ì§€ì–´ ì €ì¥
        return member;
    }
    
    @Override
    public Optional<Member> findById (Long id)
    {
        return Optional.ofNullable(store.get(id)); //nullì¸ì§€ ì•„ë‹Œì§€ íŒë³„í•´ì„œ ë¦¬í„´í•œë‹¤.
    }
    
    @Override
    public Optional<Member> findByName (String name)
    {
        return store.values().stream() //storeì˜ ê°’ë“¤ì„ streamìœ¼ë¡œ ë§Œë“ í›„
            	.filter(member -> member.getName().equals(name)) //ì°¾ëŠ” ì´ë¦„ê³¼ ê°™ì€ ì´ë¦„ì˜ memberë¥¼ ì°¾ëŠ”ë‹¤.
            	.findAny(); //ë¹„ì–´ìˆìœ¼ë©´ ë¹ˆ Optionalì„ ë°˜í™˜
    }
    
    @Override
    public List<Member> findAll()
    {
        return new ArrayList<>(store.values());
    }
    
}
    
 
```

<br/>

<hr/>

<br/>

### íšŒì› ì„œë¹„ìŠ¤ 

```java
package hello.hellospring.service;

import hello.hellospring.domain.Member;
import hello.hellospring.repository.MemberRepository;
import java.util.List;
import java.util.Optional;

public class MmeberService
{
    private final MemberRepository memberRepository = new MemberRepository();
    
    public Long join(Member member)
    {
        validateDuplicateMember (member); //ì¤‘ë³µ íšŒì›ì¸ì§€ ê²€ì¦
        memberRepository.save(member);
        return memver.getId();
    }
    
    private void validateDuplicateMember(Member member)
    {
        memberRepository.findByName(member.getName())
            	.ifPresent(m -> { //Optional ê°ì²´ê°€ ê°’ìœ¼ë¡œ ì±„ì›Œì ¸ ìˆëŠ” ê²½ìš°ì—ë§Œ ì£¼ì–´ì§„ ë™ì‘ì„ ì‹¤í–‰í•˜ëŠ” ë©”ì„œë“œì´ë‹¤.
                    throw new IllegalStateException("ì¤‘ë³µ íšŒì›ì…ë‹ˆë‹¤");
                    //IllegalStateExceptionìœ¼ë¡œ ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.
                });
    }
    
    public List<Member> findMembers()
    {
        return memberRepository.findAll();
        
    }
    
    public Optional<Member> findOne(Long memberId)
    {
        return memberRepository.findById(memberId);
    }
}
```

<br/>

ìµœëŒ€í•œ ì´í•´í•˜ë©´ì„œ ë”°ë¼ê°€ê³ ì í•˜ì˜€ê³  ê³„ì¸µ êµ¬ì¡°ì— ëŒ€í•´ íŒŒì•…í•˜ë©° ìƒì† ê´€ê³„ë¥¼ ì´í•´í•˜ëŠ”ê²Œ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í–ˆë‹¤.